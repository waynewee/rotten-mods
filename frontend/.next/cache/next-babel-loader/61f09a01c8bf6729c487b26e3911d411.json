{"ast":null,"code":"import { LOG_USER_IN, LOG_USER_OUT } from \"../redux/constants\";\nimport authApi from \"../api/auth\";\nimport courseApi from \"../api/course\";\nimport { message } from 'antd';\n\nasync function signUp(values) {\n  console.log(\"Sign Up Service received\");\n  console.log(values);\n  const {\n    fullname,\n    emailaddress,\n    userpassword,\n    university,\n    course,\n    yearofstudy\n  } = values; // let createUserConfig = {\n  //     method: 'post',\n  //     url: 'http://localhost:8080/api/user',\n  //     headers: {\n  //         'Content-Type': 'application/json'\n  //     },\n  //     data: {\n  //         \"name\": values.fullname,\n  //         \"email\": values.emailaddress,\n  //         \"password\": values.userpassword,\n  //         \"schoolId\": values.university,\n  //         \"courseId\": values.course,\n  //         \"currentYear\": values.yearofstudy\n  //     }\n  // };\n  // let createSchoolConfig = {\n  //     method: 'post',\n  //     url: 'http://localhost:8080/api/school',\n  //     headers: {\n  //         'Content-Type': 'application/json'\n  //     },\n  //     data: {\n  //         \"name\": values.fullname,\n  //     }\n  // };\n  // let createCourseConfig = {\n  //     method: 'post',\n  //     url: 'http://localhost:8080/api/course',\n  //     headers: {\n  //         'Content-Type': 'application/json'\n  //     },\n  //     data: {\n  //         \"name\": values.fullname,\n  //     }\n  // };\n  // if schoolId is user created, then create a new school in the system\n\n  if (course !== \"userCreated\" && university !== \"userCreated\") {\n    const data = await authApi.signUp(fullname, emailaddress, userpassword, university, course, yearofstudy);\n    console.log(\"sign up success\"); // login user \n    // axios(createUserConfig)\n    //     .then(function (response) {\n    //         console.log(\"post is successful\");\n    //         console.log(response);\n    //     })\n    //     .catch(function (error) {\n    //         console.log(error);\n    //     });\n  }\n}\n\nasync function logIn(values, dispatch) {\n  const {\n    emailaddress,\n    password\n  } = values;\n  const data = await authApi.logIn(emailaddress, password);\n  const {\n    name,\n    currentYear,\n    courseId,\n    _id\n  } = data;\n  const courseData = await courseApi.getCourse(courseId);\n  console.log(courseData);\n  const user = {\n    fullName: name,\n    yearOfStudy: currentYear,\n    studyCourse: courseData.name,\n    _id\n  };\n  window.localStorage.setItem(\"ROTTENMODS_EMAIL\", emailaddress);\n  window.localStorage.setItem(\"ROTTENMODS_PASSWORD\", password);\n  dispatch({\n    type: LOG_USER_IN,\n    payload: user\n  });\n  message.success(\"Successfully logged in!\");\n}\n\nfunction logOut(dispatch) {\n  window.localStorage.removeItem(\"ROTTENMODS_EMAIL\");\n  window.localStorage.removeItem(\"ROTTENMODS_PASSWORD\");\n  dispatch({\n    type: LOG_USER_OUT\n  });\n  message.success(\"Successfully logged out!\");\n}\n\nexport default {\n  signUp,\n  logIn,\n  logOut\n};","map":{"version":3,"sources":["/Users/zhangxian/Desktop/RottenMods/frontend/services/authentication.tsx"],"names":["LOG_USER_IN","LOG_USER_OUT","authApi","courseApi","message","signUp","values","console","log","fullname","emailaddress","userpassword","university","course","yearofstudy","data","logIn","dispatch","password","name","currentYear","courseId","_id","courseData","getCourse","user","fullName","yearOfStudy","studyCourse","window","localStorage","setItem","type","payload","success","logOut","removeItem"],"mappings":"AACA,SAASA,WAAT,EAAsBC,YAAtB,QAA0C,oBAA1C;AAEA,OAAOC,OAAP,MAAoB,aAApB;AACA,OAAOC,SAAP,MAAsB,eAAtB;AACA,SAASC,OAAT,QAAgC,MAAhC;;AAGA,eAAeC,MAAf,CAAsBC,MAAtB,EAA8B;AAC1BC,EAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ;AACAD,EAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ;AAGA,QAAM;AAACG,IAAAA,QAAD;AAAWC,IAAAA,YAAX;AAAyBC,IAAAA,YAAzB;AAAuCC,IAAAA,UAAvC;AAAmDC,IAAAA,MAAnD;AAA2DC,IAAAA;AAA3D,MAA0ER,MAAhF,CAL0B,CAO1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;;AAEA,MAAIO,MAAM,KAAK,aAAX,IAA4BD,UAAU,KAAK,aAA/C,EAA8D;AAE1D,UAAMG,IAAI,GAAG,MAAMb,OAAO,CAACG,MAAR,CAAeI,QAAf,EAAyBC,YAAzB,EAAuCC,YAAvC,EAAqDC,UAArD,EAAiEC,MAAjE,EAAyEC,WAAzE,CAAnB;AACAP,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAH0D,CAI1D;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH;AAEJ;;AAGD,eAAeQ,KAAf,CAAqBV,MAArB,EAA6BW,QAA7B,EAAuC;AACnC,QAAM;AAAEP,IAAAA,YAAF;AAAgBQ,IAAAA;AAAhB,MAA6BZ,MAAnC;AACA,QAAMS,IAAI,GAAG,MAAMb,OAAO,CAACc,KAAR,CAAcN,YAAd,EAA4BQ,QAA5B,CAAnB;AACA,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,WAAR;AAAqBC,IAAAA,QAArB;AAA+BC,IAAAA;AAA/B,MAAuCP,IAA7C;AACA,QAAMQ,UAAU,GAAG,MAAMpB,SAAS,CAACqB,SAAV,CAAoBH,QAApB,CAAzB;AACAd,EAAAA,OAAO,CAACC,GAAR,CAAYe,UAAZ;AACA,QAAME,IAAU,GAAG;AACfC,IAAAA,QAAQ,EAAEP,IADK;AAEfQ,IAAAA,WAAW,EAAEP,WAFE;AAGfQ,IAAAA,WAAW,EAAEL,UAAU,CAACJ,IAHT;AAIfG,IAAAA;AAJe,GAAnB;AAOAO,EAAAA,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,kBAA5B,EAAgDrB,YAAhD;AACAmB,EAAAA,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,qBAA5B,EAAmDb,QAAnD;AAEAD,EAAAA,QAAQ,CAAC;AACLe,IAAAA,IAAI,EAAEhC,WADD;AAELiC,IAAAA,OAAO,EAAER;AAFJ,GAAD,CAAR;AAIArB,EAAAA,OAAO,CAAC8B,OAAR,CAAgB,yBAAhB;AAEH;;AAED,SAASC,MAAT,CAAgBlB,QAAhB,EAA0B;AACtBY,EAAAA,MAAM,CAACC,YAAP,CAAoBM,UAApB,CAA+B,kBAA/B;AACAP,EAAAA,MAAM,CAACC,YAAP,CAAoBM,UAApB,CAA+B,qBAA/B;AAEAnB,EAAAA,QAAQ,CAAC;AACLe,IAAAA,IAAI,EAAE/B;AADD,GAAD,CAAR;AAGAG,EAAAA,OAAO,CAAC8B,OAAR,CAAgB,0BAAhB;AAEH;;AAED,eAAe;AACX7B,EAAAA,MADW;AAEXW,EAAAA,KAFW;AAGXmB,EAAAA;AAHW,CAAf","sourcesContent":["import axios from 'axios';\nimport { LOG_USER_IN, LOG_USER_OUT } from \"../redux/constants\";\nimport { User } from \"../types\";\nimport authApi from \"../api/auth\";\nimport courseApi from \"../api/course\";\nimport { message, Button } from 'antd';\n\n\nasync function signUp(values) {\n    console.log(\"Sign Up Service received\");\n    console.log(values);\n\n\n    const {fullname, emailaddress, userpassword, university, course, yearofstudy} = values;\n\n    // let createUserConfig = {\n    //     method: 'post',\n    //     url: 'http://localhost:8080/api/user',\n    //     headers: {\n    //         'Content-Type': 'application/json'\n    //     },\n    //     data: {\n    //         \"name\": values.fullname,\n    //         \"email\": values.emailaddress,\n    //         \"password\": values.userpassword,\n    //         \"schoolId\": values.university,\n    //         \"courseId\": values.course,\n    //         \"currentYear\": values.yearofstudy\n    //     }\n    // };\n\n    // let createSchoolConfig = {\n    //     method: 'post',\n    //     url: 'http://localhost:8080/api/school',\n    //     headers: {\n    //         'Content-Type': 'application/json'\n    //     },\n    //     data: {\n    //         \"name\": values.fullname,\n    //     }\n    // };\n\n    // let createCourseConfig = {\n    //     method: 'post',\n    //     url: 'http://localhost:8080/api/course',\n    //     headers: {\n    //         'Content-Type': 'application/json'\n    //     },\n    //     data: {\n    //         \"name\": values.fullname,\n    //     }\n    // };\n\n\n    // if schoolId is user created, then create a new school in the system\n\n    if (course !== \"userCreated\" && university !== \"userCreated\") {\n        \n        const data = await authApi.signUp(fullname, emailaddress, userpassword, university, course, yearofstudy);\n        console.log(\"sign up success\");\n        // login user \n\n        // axios(createUserConfig)\n        //     .then(function (response) {\n        //         console.log(\"post is successful\");\n        //         console.log(response);\n        //     })\n        //     .catch(function (error) {\n        //         console.log(error);\n        //     });\n    }\n\n}\n\n\nasync function logIn(values, dispatch) {\n    const { emailaddress, password } = values;\n    const data = await authApi.logIn(emailaddress, password);\n    const { name, currentYear, courseId, _id } = data;\n    const courseData = await courseApi.getCourse(courseId);\n    console.log(courseData);\n    const user: User = {\n        fullName: name,\n        yearOfStudy: currentYear,\n        studyCourse: courseData.name,\n        _id\n    }\n\n    window.localStorage.setItem(\"ROTTENMODS_EMAIL\", emailaddress);\n    window.localStorage.setItem(\"ROTTENMODS_PASSWORD\", password);\n\n    dispatch({\n        type: LOG_USER_IN,\n        payload: user\n    });\n    message.success(\"Successfully logged in!\");\n\n}\n\nfunction logOut(dispatch) {\n    window.localStorage.removeItem(\"ROTTENMODS_EMAIL\");\n    window.localStorage.removeItem(\"ROTTENMODS_PASSWORD\");\n\n    dispatch({\n        type: LOG_USER_OUT,\n    })\n    message.success(\"Successfully logged out!\");\n\n}\n\nexport default {\n    signUp,\n    logIn,\n    logOut\n}"]},"metadata":{},"sourceType":"module"}