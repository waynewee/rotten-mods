{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport bookmarkApi from \"../api/bookmark\";\nimport plannedModApi from \"../api/planned-mod\";\nimport reactionApi from \"../api/reaction\";\nimport { updatedPersonalPlannedModules, updatePersonalBookmarks, triggerRequireLoginMessage } from \"../utils/helpers\";\nimport ModuleSmallDetail from \"../components/ModuleSmallDetail\";\nimport UserClockIcon from \"../icons/UserClockIcon\";\nimport CoinsFilledIcon from \"../icons/CoinsFilledIcon\";\nimport HourGlassHalfFilledIcon from \"../icons/HourGlassHalfFilledIcon\";\nimport LayerGroupIcon from \"../icons/LayerGroupIcon\";\nimport StarFilledIcon from \"../icons/StarFilledIcon\";\nimport LikeFilledIcon from \"../icons/LikeFilledIcon\";\nimport StarOutlinedIcon from \"../icons/StarOutlinedIcon\";\nimport LikeOutlinedIcon from \"../icons/LikeOutlinedIcon\";\nimport UniversityIcon from \"../icons/UniversityIcon\";\nimport BookmarkFilledIcon from \"../icons/BookmarkFilledIcon\";\nimport BookmarkOutlinedIcon from \"../icons/BookmarkOutlinedIcon\";\nimport CheckboxOutlinedIcon from \"../icons/CheckboxOutlinedIcon\";\nimport { BookFilled, BookOutlined } from \"@ant-design/icons\";\nimport PencilOutlinedIcon from \"../icons/PencilOutlinedIcon\";\nimport PencilFilledIcon from \"../icons/PencilFilledIcon\";\nimport Button from \"./Button\";\nimport { codeBlue, reviewBlue, descriptionGreen, ratingsYellow } from \"../styles/colors\";\nimport AddPlannedModModal from \"./AddPlannedModModal\";\nimport { message } from \"antd\";\n\nvar ModuleInformation = function ModuleInformation(_ref) {\n  var _useSelector$find, _useSelector$find2, _schools$find, _rating$difficulty, _rating$star, _module$reaction$like, _module$reaction, _module$reaction$like2;\n\n  var module = _ref.module,\n      setAddReviewModalVisibility = _ref.setAddReviewModalVisibility,\n      setAddRatingsModalVisibility = _ref.setAddRatingsModalVisibility,\n      reviewByUser = _ref.reviewByUser,\n      updateModule = _ref.updateModule;\n\n  var _useState = useState(false),\n      isAddPlannedModModalVisible = _useState[0],\n      setAddPlannedModModalVisibility = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      likeReactionId = _useState2[0],\n      setLikeReactionId = _useState2[1]; // is true if it is reaction's id\n\n\n  var userId = useSelector(function (state) {\n    var _state$auth$user;\n\n    return (_state$auth$user = state.auth.user) === null || _state$auth$user === void 0 ? void 0 : _state$auth$user._id;\n  });\n  var bookmarkId = (_useSelector$find = useSelector(function (state) {\n    return state.personalModules.bookmarks;\n  }).find(function (bookmark) {\n    return bookmark.modId === (module === null || module === void 0 ? void 0 : module._id);\n  })) === null || _useSelector$find === void 0 ? void 0 : _useSelector$find._id;\n  var plannedModId = (_useSelector$find2 = useSelector(function (state) {\n    return state.personalModules.plannedMods;\n  }).find(function (plannedMod) {\n    return plannedMod.modId === (module === null || module === void 0 ? void 0 : module._id);\n  })) === null || _useSelector$find2 === void 0 ? void 0 : _useSelector$find2._id;\n  var schools = useSelector(function (state) {\n    return state.schools;\n  });\n  var isLoggedIn = useSelector(function (state) {\n    return state.auth.isLoggedIn;\n  });\n  var code = module.code,\n      _module$workload = module.workload,\n      workload = _module$workload === void 0 ? 10 : _module$workload,\n      rating = module.rating,\n      schoolId = module.schoolId,\n      description = module.description,\n      title = module.title,\n      _module$credit = module.credit,\n      credit = _module$credit === void 0 ? 4 : _module$credit,\n      _module$semester = module.semester,\n      semester = _module$semester === void 0 ? [1, 2] : _module$semester,\n      prereqs = module.prereqs,\n      _id = module._id;\n  var university = (_schools$find = schools.find(function (school) {\n    return school._id === schoolId;\n  })) === null || _schools$find === void 0 ? void 0 : _schools$find.name;\n  var difficulty = (rating === null || rating === void 0 ? void 0 : (_rating$difficulty = rating.difficulty) === null || _rating$difficulty === void 0 ? void 0 : _rating$difficulty.value) || 0;\n  var star = (rating === null || rating === void 0 ? void 0 : (_rating$star = rating.star) === null || _rating$star === void 0 ? void 0 : _rating$star.value) || 0;\n  useEffect(function () {\n    fetchIsLikedByUser();\n  }, [userId]);\n\n  var fetchIsLikedByUser = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var reaction;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return reactionApi.getReaction(\"mod\", module._id, userId, \"like\");\n\n            case 3:\n              reaction = _context.sent;\n              setLikeReactionId(reaction._id);\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              setLikeReactionId(\"\");\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n\n    return function fetchIsLikedByUser() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var toggleBookmark = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (isLoggedIn) {\n                _context2.next = 3;\n                break;\n              }\n\n              triggerRequireLoginMessage();\n              return _context2.abrupt(\"return\");\n\n            case 3:\n              if (bookmarkId) {\n                _context2.next = 8;\n                break;\n              }\n\n              _context2.next = 6;\n              return bookmarkApi.addBookmark(userId, _id);\n\n            case 6:\n              _context2.next = 10;\n              break;\n\n            case 8:\n              _context2.next = 10;\n              return bookmarkApi.deleteBookmark(bookmarkId);\n\n            case 10:\n              updatePersonalBookmarks(userId);\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function toggleBookmark() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var togglePlanner = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (isLoggedIn) {\n                _context3.next = 3;\n                break;\n              }\n\n              triggerRequireLoginMessage();\n              return _context3.abrupt(\"return\");\n\n            case 3:\n              if (plannedModId) {\n                _context3.next = 7;\n                break;\n              }\n\n              setAddPlannedModModalVisibility(true);\n              _context3.next = 10;\n              break;\n\n            case 7:\n              _context3.next = 9;\n              return plannedModApi.removePlannedMod(plannedModId);\n\n            case 9:\n              updatedPersonalPlannedModules(userId);\n\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function togglePlanner() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var toggleAddRatingsModal = function toggleAddRatingsModal() {\n    if (!isLoggedIn) {\n      triggerRequireLoginMessage();\n      return;\n    }\n\n    if (reviewByUser) {\n      message.error(\"You have posted a Review before. Edit your Review instead!\");\n      return;\n    }\n\n    setAddRatingsModalVisibility(true);\n  };\n\n  var toggleAddReviewModal = function toggleAddReviewModal() {\n    if (!isLoggedIn) {\n      triggerRequireLoginMessage();\n      return;\n    }\n\n    setAddReviewModalVisibility(true);\n  };\n\n  var toggleLike = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (isLoggedIn) {\n                _context4.next = 3;\n                break;\n              }\n\n              triggerRequireLoginMessage();\n              return _context4.abrupt(\"return\");\n\n            case 3:\n              if (!likeReactionId) {\n                _context4.next = 8;\n                break;\n              }\n\n              _context4.next = 6;\n              return reactionApi.deleteReaction(likeReactionId);\n\n            case 6:\n              _context4.next = 10;\n              break;\n\n            case 8:\n              _context4.next = 10;\n              return reactionApi.addReaction(\"mod\", module._id, userId, \"like\");\n\n            case 10:\n              fetchIsLikedByUser();\n              updateModule();\n\n            case 12:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function toggleLike() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    style: styles.container\n  }, __jsx(\"div\", {\n    style: styles.moduleMeta\n  }, __jsx(\"div\", {\n    style: styles.moduleInformation\n  }, __jsx(\"div\", {\n    style: styles.moduleCode\n  }, code), __jsx(\"div\", {\n    style: styles.moduleSmallDetailsColumn\n  }, __jsx(ModuleSmallDetail, {\n    Icon: UniversityIcon,\n    text: \"University: \".concat(university !== null && university !== void 0 ? university : \"-\"),\n    iconStyle: styles.iconStyle\n  }), __jsx(ModuleSmallDetail, {\n    Icon: HourGlassHalfFilledIcon,\n    text: \"Semester(s) offered: \".concat(semester.sort().join(\", \") || \"-\"),\n    iconStyle: styles.iconStyle\n  })), __jsx(\"div\", {\n    style: styles.moduleSmallDetailsColumn\n  }, __jsx(ModuleSmallDetail, {\n    Icon: CoinsFilledIcon,\n    text: \"Credit: \".concat(credit),\n    iconStyle: styles.iconStyle\n  }), __jsx(ModuleSmallDetail, {\n    Icon: UserClockIcon,\n    text: \"Workload/Week: \".concat(workload, \" hours\"),\n    iconStyle: styles.iconStyle\n  })), __jsx(\"div\", {\n    style: styles.moduleSmallDetailsColumn\n  }, __jsx(ModuleSmallDetail, {\n    Icon: CheckboxOutlinedIcon,\n    text: \"Pre-reqs: \".concat(prereqs.join(\", \") || \"None\"),\n    iconStyle: styles.iconStyle\n  }), __jsx(ModuleSmallDetail, {\n    Icon: LayerGroupIcon,\n    text: \"Difficulty: \".concat(difficulty.toFixed(1) == \"0.0\" ? \"-\" : difficulty.toFixed(1), \"/5\"),\n    iconStyle: styles.iconStyle\n  }))), __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"space-between\",\n      alignContent: \"center\",\n      height: \"100%\",\n      fontSize: 14\n    }\n  }, __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      justifyContent: \"flex-end\",\n      padding: \"10px 10px 10px 0px\",\n      width: \"100%\",\n      color: \"#838383\"\n    }\n  }, __jsx(\"div\", {\n    style: {\n      marginRight: 10\n    }\n  }, __jsx(LikeFilledIcon, {\n    style: {\n      height: 20,\n      color: codeBlue,\n      margin: \"0px 10px\",\n      position: \"relative\",\n      bottom: -2\n    }\n  }), \"\".concat((_module$reaction$like = (_module$reaction = module.reaction) === null || _module$reaction === void 0 ? void 0 : (_module$reaction$like2 = _module$reaction.like) === null || _module$reaction$like2 === void 0 ? void 0 : _module$reaction$like2.count) !== null && _module$reaction$like !== void 0 ? _module$reaction$like : 0)), __jsx(\"div\", null, __jsx(StarFilledIcon, {\n    style: {\n      height: 20,\n      color: ratingsYellow,\n      margin: \"0px 10px\",\n      position: \"relative\",\n      bottom: -2\n    }\n  }), \"\".concat(star.toFixed(1)))), __jsx(\"div\", {\n    style: styles.actionsBar\n  }, __jsx(Button, {\n    onClick: toggleLike\n  }, likeReactionId ? __jsx(LikeFilledIcon, {\n    style: _objectSpread(_objectSpread({}, styles.actionIcon), {}, {\n      color: codeBlue,\n      fontSize: 25\n    })\n  }) : __jsx(LikeOutlinedIcon, {\n    style: _objectSpread(_objectSpread({}, styles.actionIcon), {}, {\n      color: codeBlue,\n      fontSize: 25\n    })\n  })), __jsx(Button, {\n    onClick: togglePlanner\n  }, plannedModId ? __jsx(BookFilled, {\n    style: _objectSpread(_objectSpread({}, styles.actionIcon), {}, {\n      color: \"#76CCB7\",\n      fontSize: 25\n    })\n  }) : __jsx(BookOutlined, {\n    style: _objectSpread(_objectSpread({}, styles.actionIcon), {}, {\n      color: \"#76CCB7\",\n      fontSize: 25\n    })\n  })), __jsx(Button, {\n    onClick: toggleBookmark\n  }, bookmarkId ? __jsx(BookmarkFilledIcon, {\n    style: _objectSpread(_objectSpread({}, styles.actionIcon), {}, {\n      color: \"#289FA7\"\n    })\n  }) : __jsx(BookmarkOutlinedIcon, {\n    style: _objectSpread(_objectSpread({}, styles.actionIcon), {}, {\n      color: \"#289FA7\"\n    })\n  })), __jsx(Button, {\n    onClick: toggleAddRatingsModal\n  }, __jsx(StarOutlinedIcon, {\n    style: _objectSpread(_objectSpread({}, styles.actionIcon), {}, {\n      color: ratingsYellow\n    })\n  })), __jsx(Button, {\n    onClick: toggleAddReviewModal\n  }, reviewByUser ? __jsx(PencilFilledIcon, {\n    style: _objectSpread(_objectSpread({}, styles.actionIcon), {}, {\n      width: 25,\n      fill: reviewBlue\n    })\n  }) : __jsx(PencilOutlinedIcon, {\n    style: _objectSpread(_objectSpread({}, styles.actionIcon), {}, {\n      width: 25,\n      fill: reviewBlue\n    })\n  }))))), __jsx(\"div\", {\n    style: styles.infoContainer\n  }, __jsx(\"div\", {\n    style: styles.moduleTitle\n  }, title), __jsx(\"div\", {\n    style: styles.moduleDescription\n  }, description)), __jsx(AddPlannedModModal, {\n    isModalVisible: isAddPlannedModModalVisible,\n    setModalVisibility: setAddPlannedModModalVisibility,\n    modId: _id,\n    userId: userId,\n    plannedModId: plannedModId\n  }));\n};\n\nvar styles = {\n  container: {\n    fontFamily: \"Roboto\",\n    marginTop: 30\n  },\n  moduleMeta: {\n    display: \"flex\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    height: 80\n  },\n  moduleInformation: {\n    display: \"flex\",\n    justifyContent: \"flex-start\"\n  },\n  moduleCode: {\n    backgroundColor: codeBlue,\n    height: 80,\n    borderRadius: 12,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    fontSize: \"26px\",\n    color: \"white\",\n    padding: \"0px 30px\",\n    boxShadow: \"0px 4px 4px rgba(0, 0, 0, 0.25)\"\n  },\n  moduleSmallDetailsColumn: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    justifyContent: \"space-between\"\n  },\n  actionsBar: {\n    display: \"flex\"\n  },\n  actionIcon: {\n    height: 25,\n    margin: \"0px 10px\"\n  },\n  infoContainer: {\n    backgroundColor: descriptionGreen,\n    marginTop: 10,\n    borderRadius: 15,\n    padding: \"20px 30px 30px 30px\",\n    color: \"#fff\",\n    boxShadow: \"0px 8px 8px rgba(0, 0, 0, 0.25)\"\n  },\n  moduleTitle: {\n    fontSize: 30,\n    fontWeight: \"bold\"\n  },\n  moduleDescription: {\n    textAlign: \"justify\",\n    fontWeight: 300\n  },\n  iconStyle: {\n    color: \"#B9B9B9\"\n  }\n};\nexport default ModuleInformation;","map":null,"metadata":{},"sourceType":"module"}